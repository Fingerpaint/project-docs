% Below command is used to add rows to the SRD to ADD matrix,
% it takes care of the number of columns automatically
\newcounter{srdtoaddcount}
\newcommand{\srdtoaddline}[2]{%
	\srqref{#1} & #2 \ifthenelse{\isodd{\thesrdtoaddcount}}{\\}{&}%
	\stepcounter{srdtoaddcount}
}
% Below command makes sure that a line the table is ended, when an odd number
% of things is added to the table
\newcommand{\srdtoaddendline}{%
	\ifthenelse{\isodd{\thesrdtoaddcount}}{& \\\stepcounter{srdtoaddcount}}{}
}
% Below command makes adding SRQs easier
% http://tex.stackexchange.com/questions/82253/parse-variable-length-comma-separated-list-into-command
\makeatletter
\newcommand\addtosrdlist[1]{%
  \def\tempa{}%
  \@for\reserved:=#1\do{%
    \ifx\tempa\empty\else, \fi\srqref{\reserved}%
    \edef\tempa{something}%
  }
}
\makeatother

% Needed for proper breaking
\let\oldRTMCUAP\RTMCUAP{}
\renewcommand{\RTMCUAP}{Client.UpdateApplication-Persistence}

\chapter{Requirements Traceability Matrix}
\label{chap:reqtracematrix}
In this chapter, we link SRQs, described in the SRD \cite{srd}, to the components described in this document. We also do this the other way round, namely listing which SRQs are implemented in a component.

\section{SRD to ADD}
The following matrix lists which components are linked to the SRQs in the SRD.

\LTXtable{\textwidth}{chapter7.srdtoaddmatrix}
\let\RTMCUAP\oldRTMCUAP

\section{ADD to SRD}
The following matrix lists which SRQs are implemented by each component.

%\begin{center}
%  \begin{tabularx}{\textwidth}{lX}
%    \toprule
%    \textbf{Component} & \textbf{SRQ(s)} \\
%    \midrule
%    \RTMCAS{}  & \addtosrdlist{AS-2,AS-6,AS-7,CP-1,CP-2,CP-3,CP-4,CP-5,CP-6,CP-7,savedistr,savename,savebutton,CP-14} \\
%    \RTMCCP{}  & \addtosrdlist{CP-0, CP-1,CP-2,CP-3,CP-4,CP-5,CP-6,CP-7,savebutton,CP-14,displayload,CP-28} \\
%    \RTMCL{}   & \addtosrdlist{shapedraw,CB-12,circleshaped,squareshaped,CB-13,CB-2,CB-3,CB-4,CB-6,CB-5,CB-7,selgeomrec,selmixer,selgeomsq,selgeomcir,selgeomjb,CB-8,prevsaved,CB-9,predef,CB-10,stepsize,protocolrepeat,CB-14,CB-15,startMixing,CB-16,CB-17,visResults,CB-16-2,CP-1,CP-2,CP-3,CP-4,CP-5,CP-6,CP-7,savedistr,savename,CP-9,CP-10,loaddistbutton,loadlist,loadload,CP-14,removeinit,listsaved,selectremove,suremessage,nosaveddistr,insuffrights,gengraph,gendist,exportname,initload,selectload,displayload,CP-28,selLang,SSC-3,SSC-4,SSC-5,SSC-6,englan,dutlan,NONF-6,NONF-7,NONF-8,NONF-9,NONF-10,NONF-11,NONF-12,NONF-13} \\
%    \RTMSAP{}  & \addtosrdlist{AS-1,AS-3,AS-5,APC-1,APC-2,AP-1,AP-2,AP-5,AP-6,CP-0} \\
%    \RTMSAS{}  & \addtosrdlist{AS-1,AS-2,AS-3,AS-5,AS-6,AS-7,AP-1,AP-2,AP-5,AP-6,ASC-1,ASC-2,CB-17,sendParams,returnParams,SS-2} \\
%    \RTMSFM{}  & \addtosrdlist{CB-17,execMixing,returnMixing,SS-4,FM-1,FM-2,FM-3} \\
%    \RTMSHS{}  & \addtosrdlist{HTTP-1,CB-17,SS-2} \\
%    \RTMSSS{}  & \addtosrdlist{AS-7,CB-17,sendParams,returnParams,execMixing,returnMixing,SS-2,SS-4} \\
%    \bottomrule
%  \end{tabularx}
%\end{center}

\begin{center}
  \begin{tabularx}{\textwidth}{lX}
    \toprule
    \textbf{Component} & \textbf{SRQ(s)} \\
    \midrule
    \RTMCAS{}  & \addtosrdlist{CB-8,prevsaved,CB-9,predef,CB-10,CB-17,visResults,CB-16-2,CP-4,CP-5,CP-6,CP-7,savebutton,CP-10,loadlist,CP-14,listsaved,exportname,initload,displayload,CP-28,selLang,SS-2,NONF-1,NONF-2,NONF-3,englan,dutlan,NONF-6,NONF-7,NONF-8,NONF-9,NONF-10,NONF-11,NONF-12,NONF-13} \\
    \RTMCCP{}  & \addtosrdlist{prevsaved,predef,CP-0,CP-4,CP-5,CP-6,CP-7,savebutton,loadlist,CP-14,listsaved,initload,displayload,englan,dutlan,NONF-6,NONF-7,NONF-8,NONF-9,NONF-10,NONF-11,NONF-12,NONF-13} \\
    \RTMCL{}   & \addtosrdlist{shapedraw,CB-12,circleshaped,squareshaped,CB-13,CB-2,CB-3,CB-4,CB-6,CB-5,CB-7,selgeomrec,selmixer,selgeomsq,selgeomcir,selgeomjb,CB-8,prevsaved,CB-9,predef,CB-10,stepsize,protocolrepeat,CB-14,CB-15,startMixing,CB-16,visResults,CB-16-2,CP-1,CP-2,CP-3,CP-4,CP-5,CP-6,CP-7,savedistr,savename,savebutton,CP-9,CP-10,loaddistbutton,loadlist,loadload,removeinit,listsaved,selectremove,suremessage,nosaveddistr,insuffrights,distimg,gengraph,gendist,initload,selectload,displayload,CP-28,selLang,SSC-3,SSC-4,SSC-6,NONF-1,NONF-2,NONF-3,englan,dutlan,NONF-6,NONF-7,NONF-8,NONF-9,NONF-10,NONF-11,NONF-12,NONF-13} \\
    
    \RTMSAP{}  & \addtosrdlist{APC-1,APC-2,AP-1,AP-2,AP-5,AP-6,NONF-1,NONF-2,NONF-3} \\
    \RTMSAS{}  & \addtosrdlist{AS-1,AS-2,AS-3,AS-5,AS-6,AS-7,APC-1,APC-2,ASC-1,ASC-2,CB-17,sendParams,returnParams,SS-2,NONF-1,NONF-2,NONF-3} \\
    \RTMSFM{}  & \addtosrdlist{CB-17,SS-4,FM-1,FM-2,FM-3,NONF-1,NONF-2,NONF-3} \\
    \RTMSHS{}  & \addtosrdlist{HTTP-1} \\
    \RTMSSS{}  & \addtosrdlist{CB-17,sendParams,returnParams,execMixing,returnMixing,SS-2,SS-4,NONF-1,NONF-2,NONF-3} \\
    \bottomrule
  \end{tabularx}
\end{center}
