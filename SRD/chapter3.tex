\chapter{Specific requirements}
\label{chap:specreq}
This chapter lists all specific software requirements of the application to be developed, both functional and non-functional requirements. The requirements are categorised according to the interface they belong to, as described in section \ref{sec:moddesc}.

Each requirement has a specific priority, based on the MoSCoW model \cite{moscow}:

\begin{itemize}
    \item \emph{must have}; requirements with this priority are essential for the product, and must be implemented.
    \item \emph{should have}; requirements with this priority are not essential for the product to work. However, they are nearly as important as the \emph{must have}'s and are therefore expected to be implemented.
    \item \emph{could have}; requirements with this priority are a nice addition to the product, and may be implemented, if time and budget allow this.
    \item \emph{won't have}; requirements with this priority will not be implemented in this version of the product, but may be nice to implement in future versions.
\end{itemize}

Only those user requirements from the URD \cite{urd} with a priority higher then \emph{won't have} will be translated to software requirements in this chapter.

\todo{Moeten we dit inderdaad zo doen met die GWT verwijzing, of noemen we het juist niet zo specifiek?}
Note that as \applicationname\ is developed using GWT, some of the software requirements listed in this chapter are described in terms of specific GWT widgets or panels\footnote{The website for the GWT widgetlist can be found at \url{https://developers.google.com/web-toolkit/doc/latest/RefWidgetGallery}.}.

\todo{Requirements groeperen naar: MixerProvider, MixerPersistance, Client, ClientPersistence, SimulatorServer}

\section{Functional requirements}
\label{sec:funcreq}
This section lists the functional requirements for the \projectname app.

\subsection{MixerProvider}

\subsection{MixerPersistenceCommunication}

\subsection{MixerPersistence}

\subsection{MixerProviderCommunication}

\subsection{Client}
\subsubsection{Set options for a mixing protocol}
A duration can be any value that can be created by combining the possible values for $D$ (the step size), namely 4, 2, 1, 0.5, 0.25 and 0.1. Such a value $D$ can be entered in a text box near the drawing canvas. If an invalid value is entered -- i.e. a value that cannot be created by combining the mentioned values -- the user is prompted to enter a different value.

To indicate how many times the protocol created using the above items is executed, the user can enter a number in a spinner. We use a spinner because the number it contains can easily be incremented or decremented by using the arrow keys, and a value that is not near the original value can easily be entered using its text box.

\SRQ[srq:stepsize]{must have}{ % CPR20
    The user can enter the step size in a text box.
}

\SRQ{must have}{ % CPR21
    The user can indicate via a spinner how many times the protocol should be applied.
}

\subsubsection{Define mixing protocol for specific geometries}
For the rectangular or square geometries, a wall movement is defined by either $T$ or $B$, denoting a movement of the top or bottom wall, respectively. Each movement is performed for $D$ time units, which can be set using \srqref{srq:stepsize}. Looking directly at the screen, a $T$ movement indicates that the top wall should move to the right, and a $B$ movement indicates that the bottom wall should move to the left. Each of these wall movements can be combined with a `$-$' sign, to indicate that the direction of movement should be reversed. This means $-T$, for example, indicates that the top wall should move to the \emph{left}.

The circular geometry does not support movements, and as such a mixing protocol is immediately defined after selecting a mixer.

For the \emph{Journal bearing} geometry, the user can swipe across the screen to indicate movements. Swiping to the right near the top of the outer circle means the outer circle rotates clockwise for $D$ time units, and swiping to the right near the top of the inner circle means the inner circle rotates clockwise for $D$ time units.

\SRQ{must have}{ % CPR17a
    The \emph{Step} class contains a movement and a duration for this movement.
}

\SRQ{must have}{ % CPR17b, CPR25, CPR26, CPR27
    The \emph{Protocol} class contains a list of \emph{Step}s.
}

\SRQ[srq:startMixing]{must have}{ % CPR29a
    After defining a mixer, a mixing protocol and an initial distribution, the user can press the \texttt{Mix} button to execute the actual mixing.
}

\SRQ[srq:visResults]{must have}{ % CPR29e
    After the client receives the JSON object containing the concentration distribution and the performance result from the server, the client un-JSON's these items. The concentration distribution is visualised on the client's screen, using the canvas that was originally used to draw the initial concentration distribution. The performance result is visualised on the screen at the same time using a number. % TODO: If multiple runs are being received one after another, plot the performance.
}

\SRQ{must have}{ % CPR19
    The user can press the \texttt{Reset} button to clear the current canvas, which is equivalent to completely colouring it white.
}

\subsubsection{Execute mixing runs}
The user can choose to execute a single step of a mixing protocol, by choosing a single \emph{Step}. This invokes \srqref{srq:startMixing}, \srqref{srq:sendParams}, \srqref{srq:readParams}, \srqref{srq:execMixing}, \srqref{srq:returnParams} and \srqref{srq:visResults}.

\SRQ{must have}{ % CPR18
    After selecting a geometry, a mixer, an initial distribution and a single \emph{Step}, the user can press the \texttt{Execute step} button to execute a single step.
}

\subsection{ClientPersistence}
To manage mixing protocols, the user can save and load the mixing protocols they have created. It is also possible to load a predefined mixing protocol.

\SRQ{should have}{ % CPR22
    The user can click the \texttt{Save} button to save the mixing protocol to their device. The desired name for the protocol can then be specified in the pop-up that appears.
}

\SRQ{should have}{ % CPR23
    The user can press the \texttt{Remove} button to remove the saved protocol from the device.
}

\SRQ{should have}{ % CPR24
    After the user has selected the geometry and the mixer using \srqref{srq:selgeomrec}, \srqref{srq:selgeomsq}, \srqref{srq:selgeomcir} or \srqref{srq:selgeomjb} and \srqref{srq:selmixer}, they can choose to load a previously saved mixing protocol by choosing the \texttt{Load} option in the third level of the menu. This spawns a fourth menu level with the names of all applicable saved protocols. Clicking one such protocol loads it.
}

\SRQ{could have}{ % CPR28
    After \srqref{srq:selgeomrec}, \srqref{srq:selgeomsq}, \srqref{srq:selgeomcir} or \srqref{srq:selgeomjb} and \srqref{srq:selmixer}, the user selects the \texttt{Predefined} option in the third level of the \texttt{Mixer} menu. This spawns a fourth level of the menu containing all suitable predefined mixing protocols for the selected geometry. Clicking one such protocol selects it, which means it will be used once the mixing is executed.
}

\subsubsection{Mixing runs}
\SRQ{must have}{ % CPR30
    After the mixing has been executed, the user can save the results on their device by pressing the \texttt{Save} button. This opens a pop-up using which the user can enter a name for the results.
}

\SRQ{must have}{ % CPR31
    In the menu with previously saved mixing runs, the user can press the \texttt{Remove} button to remove this saved run from storage.
}

\subsection{SimulatorServerCommunication}
To execute a mixing protocol, the following SRQs are executed in this order: \srqref{srq:startMixing}, \srqref{srq:sendParams}, \srqref{srq:readParams}, \srqref{srq:execMixing}, \srqref{srq:returnParams} and \srqref{srq:visResults}.

\SRQ[srq:sendParams]{must have}{ % CPR29b
    The parameters (initial concentration distribution, geometry, mixing protocol, mixer and number of protocol applications) are JSON'ed and sent to the server using a socket.
}

\SRQ[srq:readParams]{must have}{ % CPR29c
    The server un-JSON's the parameters.
}

\SRQ[srq:returnParams]{must have}{ % CPR29d
    The server JSON's the resulting concentration distribution and the performance result and sends this JSON object back to the client using the socket.
}

\subsection{SimulatorServer}
\SRQ[srq:execMixing]{must have}{ %CRP29c2
     The server executes the mixing using the parameters received via the socket. The concentration distribution and mixing protocol are given to the \textsc{Fortran} implementation.
}

The user can select a rectangular mixer geometry. To this end, a cell browser is available that lists all the available geometries in the first column. This first column will contain several geometries, including ``rectangle", `` square", ``circle" or ``\emph{Journal Bearing}". After clicking on a certain geometry, the available mixers for this geometry are displayed in the second column of the cell browser. The user can now select a mixer of choice and then, the third column in the cell browser lists all the available starting concentration distributions for the selected mixer. There are three types of starting concentration distributions that the user can choose from. The first type is a ``blank" concentration distribution, which simply means that the user will be presented with a clean canvas when this option is selected. The second type is a ``load" option, so the user can load previously saved concentration distributions that are stored on their device. The third type of concentration distribution is a ``predefined" distribution, meaning that the user can choose from a few predefined distributions that are already present in the application. In case of the second and third option, there will be a third column in the cell browser that lists all the available concentration distributions that can be loaded. When the user clicks on an item in the third column, the required distribution is immediately loaded on an appropriate canvas. For the first option, a blank canvas is displayed on the screen when the user clicks on ``blank". \\
This user requirement can then be described with the following software requirements:

\SRQ[srq:selgeomrec]{must have}{The user can select ``rectangle" as a geometry, via the first column in a cell browser.} % CPR1
\SRQ[srq:selmixer]{must have}{After having selected a geometry, the user can select a mixer that fits the selected geometry. The mixer can be selected via a second column in a cell browser.} % CPR2
\SRQ[srq:selgeomsq]{should have}{The user can select ``square" as a geometry, via the first column in a cell browser.}  % CPR3
\SRQ[srq:selgeomcir]{could have}{The user can select ``circle" as a geometry, via the first column in a cell browser.}  % CPR4
\SRQ[srq:selgeomjb]{could have}{The user can select ``\emph{Journal Bearing}" as a geometry, via the first column in the cell browser.}  % CPR5
\SRQ{must have}{The user can select a blank canvas, by choosing the ``blank" option in the third column in the cell browser.} % CPR6\
\SRQ[prevsaved]{should have}{The user can view a list of all previously saved concentration distributions, by choosing the ``load" option in the third column in the cell browser.} % CPR13
\SRQ{should have}{After selecting the ``load" option from \srqref{prevsaved}, the user can select a previously saved distribution by clicking on one distribution in the fourth column in the cell browser.} % CPR13
\SRQ[predef]{should have}{The user can view a list of all predefined concentration distributions, by choosing the ``predefined" option in the third column in the cell browser.} % CPR14
\SRQ{should have}{After selecting the ``predefined" option from \srqref{predef}, the user can select a predefined initial concentration distribution by clicking on one distribution in the fourth column in the cell browser.} % CPR14

% TODO: hier nog alle requirements van het loaden van distributies en de pre-defined shit

Requirements regarding the initial concentration distribution input:

MixerProvider/SimulatorService Communication+MixdrPersistence requirements:
Zorg dat alle functionaliteit van de SimulatieServer beschikbaar is (stel de volledige API/data bloot)
snel genoeg, et cetera.

\todo{VRAAG: moeten we er een losse requirement van maken dat de user op een canvas tekent? Ik vind het uit onderstaande
 requirements nu niet geheel duidelijk dat het om exact hetzelfde canvas gaat iedere keer.}
\todo{VRAAG: moeten we naar GWT componenten verwijzen met hoofdletters of niet?}

\SRQ{must have}{The user can select a colour (black or white) to paint with for the initial concentration distribution, via a Toggle Button.} % CPR6
\SRQ{must have}{The user can define an initial concentration distribution with the selected colour on the canvas, by drawing with their finger.} % CPR6
\SRQ[circleshaped]{must have}{The user can select a circle-shaped drawing tool via a pop-up panel.} % CPR7
\SRQ{must have}{The user can draw with a circle-shaped drawing tool on the canvas.} % CPR7, los omdat de square een lagere prioriteit heeft in het URD
\SRQ{must have}{The user can reset the current concentration distribution to a completely white concentration distribution, by clicking on the ``Reset" button.} % CPR8
\SRQ[squareshaped]{should have}{The user can select a square-shaped drawing tool via a pop-up panel.} % CPR9
\SRQ{should have}{The user can draw with a square-shaped drawing tool on the canvas.} % CPR9
\SRQ{should have}{The user can adjust the size of the drawing tool, using a slider in the popup panel from \srqref{circleshaped} and \srqref{squareshaped}}. % CPR10
\SRQ{should have}{The user can save an initial concentration distribution locally on their device, using a button and popup panel.} % CPR11

The user can remove a previously saved initial concentration distribution. To this end, a ``Remove saved distributions" button is available. When the user clicks this button, a new screen opens with a cell list that shows all the available saved concentration distributions, along with a check box next to each item. The ``Remove saved distributions" button will remain visible in this new screen. The user can then select one or more items to be removed using the check boxes. When the remove button is pressed, all the selected items from the cell list will be removed and the user returns to the previous screen. \todo{Moet ik hier al iets zeggen over de verschillende schermen?} \\
This user requirement can then be described with the following software requirements:

\SRQ{should have}{There is a ``Remove saved distributions" button to remove previously saved distributions.} % CPR12
\SRQ{should have}{After clicking the ``Remove saved distributions" button, a cell list is shown that provides all the previously saved concentration distributions.} % CPR12
\SRQ{should have}{Each item from in the cell list of PREVIOUS contains a check box that can be selected or deselected, to indicate which distributions should be removed.} % CPR12
\SRQ{should have}{After selecting at least one item from PREVIOUS, the user can press the ``Remove saved distributions" button and the selected items are removed from the device.} % CPR12

Requirements regarding the presentation of results: \\
The user is able to visualise his mixing protocol, as well as able to save and export these results. To this end a results window is available. In the results window there is a `show statistics' button. When pressed, the performance of the mixing run is shown in a graph. The results window is reached by pressing the `start mixing' button in the mixing protocol window. The mixing protocol window is the window where the user can define his mixing protocol. In the mixing protocol window there is a `animate mixing' checkbox. If this checkbox was checked when the `start mixing' button is pressed, an animation of the mixing procedure is shown in the results window.

\SRQ{must have}{In the results window the result of the user's mixing protocol is shown.}
%CPR32

\SRQ{must have}{The user can use the `show performance' button to get visual information of the performance of the mixing run.}
%CPR34

\SRQ{could have}{An animation of the mixing run is shown in the results window if the `animate mixing' checkbox is checked.}
%CPR38

Requirements regarding saving and exporting results: \\
In the results window a `save' button, an `export' button and a `load results' button are available. If the `export' button is pressed, a popup with several available export options is shown: `export performance', `export picture' and `export animation'. `export animation' is only available if the `animate mixing' checkbox was checked. Additionally, a `load performance' button. The user can use this button to open a popup. In this popup he can select the files he wants to load. The button changes to `load selected' and now loads all the selected files.

\SRQ{should have}{The `export picture' option can be used to export an image of the mixing result somewhere on the device.}
%CPR33

\SRQ{should have}{The `export performance' option can be used to export an image of the current performance graph somewhere on the device.}
%CPR35&37

\SRQ{should have}{Data loaded with the `load performance' button is depicted in a single performance graph.}
%CPR36

\SRQ{could have}{The `export animation' button can be used to export an animation of the mixing procedure somewhere on the device.}
%CPR39

Language selection: \\
In the menu bar a flag of the currently selected language is visible. When clicked, a popup appears containing several language options, each symbolised by the flag of their country. These flags can be clicked to change the language to that specific language. Standard language is English.

\SRQ{should have}{It should be possible to switch to Dutch langage with the language menu.}
%CPR41

\section{Non-functional requirements}
\label{sec:nonfuncreq}
\todo{individual sections for non-functional requirements}

\subsection{Performance}
\SRQ{must have}{Waiting time between submitting input and receiving output is no longer than 5 seconds.}
%CNR10

\SRQ{should have}{Waiting time between submitting input and receiving output is no longer than 3 seconds.}
%CNR11

\SRQ{could have}{Waiting time between submitting input and receiving output is no longer than 1 seconds.}
%CNR12

\subsection{Interface}

\todo{Hier zegguh dat wij Fortran servertje gebruikuh.}

\SRQ{must have}{An English interface is available}
%CPR40

\subsection{Operational}
\subsection{Resource}
\subsection{Verification and testing}
\subsection{Portability}
\SRQ{must have}{The application runs on iOS Safari version 6.0 and higher.}
%CNR1

\SRQ{should have}{The application runs on Firefox version 20 and higher.}
%CNR2

\SRQ{should have}{The application runs on Google Chrome version 26 and
higher.}
%CNR3

\SRQ{could have}{The application runs on Internet Explorer version 10 and higher.}
%CNR4

\SRQ{could have}{The application runs on Safari version 6.0 and higher.}
%CNR5

\SRQ{must have}{The application runs on devices running on iOS version 6 and higher.}
%CNR7

\SRQ{should have}{The application runs on devices running on Android version 4.0 and higher.}
%CNR8

\SRQ{could have}{The application runs on devices running on Windows 8.}
%CNR9

\subsection{Maintainability}
\subsection{Reliability}
\subsection{Security}
\subsection{Safety}
\subsection{Documentation}
\subsection{Extensibility}

\SRQ{must have}{The application should be easily extendable with new mixers.}
%CNR13
